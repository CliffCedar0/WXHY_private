import{s as t,v as a,c as e,w as s,i,o as n,a as l,b as o,t as r,h as u,l as g,g as c,k as f,F as h,e as d}from"./index-CNSh8vwB.js";import{l as m,a as y}from"./sizhu.j5o8EW_k.js";import{g as z}from"./xingnian.CHB5KPs2.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],p=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],x=["","天蓬","天芮","天冲","天辅","天禽","天心","天柱","天任","天英"],j=["冬至","小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种"],k={"冬至":[1,7,4],"小寒":[2,8,5],"大寒":[3,9,6],"立春":[8,5,2],"雨水":[9,6,3],"惊蛰":[1,7,4],"春分":[3,9,6],"清明":[4,1,7],"谷雨":[5,2,8],"立夏":[4,1,7],"小满":[5,2,8],"芒种":[6,3,9],"夏至":[9,3,6],"小暑":[8,2,5],"大暑":[7,1,4],"立秋":[2,5,8],"处暑":[1,4,7],"白露":[9,3,6],"秋分":[7,1,4],"寒露":[6,3,9],"霜降":[5,2,8],"立冬":[6,3,9],"小雪":[5,2,8],"大雪":[4,1,7]},I={"甲子":"海中金","乙丑":"海中金","丙寅":"炉中火","丁卯":"炉中火","戊辰":"大林木","己巳":"大林木","庚午":"路旁土","辛未":"路旁土","壬申":"剑锋金","癸酉":"剑锋金","甲戌":"山头火","乙亥":"山头火","丙子":"涧下水","丁丑":"涧下水","戊寅":"城头土","己卯":"城头土","庚辰":"白蜡金","辛巳":"白蜡金","壬午":"杨柳木","癸未":"杨柳木","甲申":"泉中水","乙酉":"泉中水","丙戌":"屋上土","丁亥":"屋上土","戊子":"霹雳火","己丑":"霹雳火","庚寅":"松柏木","辛卯":"松柏木","壬辰":"长流水","癸巳":"长流水","甲午":"沙中金","乙未":"沙中金","丙申":"山下火","丁酉":"山下火","戊戌":"平地木","己亥":"平地木","庚子":"壁上土","辛丑":"壁上土","壬寅":"金箔金","癸卯":"金箔金","甲辰":"佛灯火","乙巳":"佛灯火","丙午":"天河水","丁未":"天河水","戊申":"大驿土","己酉":"大驿土","庚戌":"钗钏金","辛亥":"钗钏金","壬子":"桑柘木","癸丑":"桑柘木","甲寅":"大溪水","乙卯":"大溪水","丙辰":"沙中土","丁巳":"沙中土","戊午":"天上火","己未":"天上火","庚申":"石榴木","辛酉":"石榴木","壬戌":"大海水","癸亥":"大海水"},G=t=>I[t]||"",w={"冬至":{"上候":1,"中候":7,"下候":4},"立春":{"上候":8,"中候":5,"下候":2},"春分":{"上候":3,"中候":9,"下候":6},"立夏":{"上候":4,"中候":1,"下候":7},"夏至":{"上候":9,"中候":3,"下候":6},"立秋":{"上候":2,"中候":5,"下候":8},"秋分":{"上候":7,"中候":1,"下候":4},"立冬":{"上候":6,"中候":3,"下候":9}},C={"小寒":{"上候":2,"中候":8,"下候":5},"雨水":{"上候":9,"中候":6,"下候":3},"清明":{"上候":4,"中候":1,"下候":7},"小满":{"上候":5,"中候":2,"下候":8},"小暑":{"上候":8,"中候":2,"下候":5},"处暑":{"上候":1,"中候":4,"下候":7},"寒露":{"上候":6,"中候":9,"下候":3},"小雪":{"上候":5,"中候":8,"下候":2}},T={"大寒":{"上候":3,"中候":9,"下候":6},"惊蛰":{"上候":1,"中候":7,"下候":4},"谷雨":{"上候":5,"中候":2,"下候":8},"芒种":{"上候":6,"中候":3,"下候":9},"大暑":{"上候":9,"中候":1,"下候":4},"白露":{"上候":6,"中候":3,"下候":6},"霜降":{"上候":7,"中候":1,"下候":4},"大雪":{"上候":7,"中候":1,"下候":1}};function D(t){if(!t||t.length<2)return 1;const a=t[0],e=t[1],s=b.indexOf(a),i=p.indexOf(e);if(-1===s||-1===i)return 1;for(let n=0;n<60;n++){const t=b[n%10],s=p[n%12];if(t===a&&s===e)return n+1}return 1}function S(t,a,e){let s=t;const i=(a-1)%9;for(let n=0;n<i;n++)s=e?s%9+1:1===s?9:s-1;return s}function N(t){if(!t||t.length<2)return"";const a=t.charAt(0),e=t.charAt(1),s=b.indexOf(a),i=p.indexOf(e);if(-1===s||-1===i)return"";const n=(i-s+12)%12;return p[(n+10)%12]+p[(n+11)%12]}function X(t,a,e={}){const s=new Date(`${t}T${a}:00`),i=m.Solar.fromDate(s);let n={};if(e&&e.bazi)n=e.bazi;else{const t=y(s);if(!t)return{error:"四柱计算失败"};n={year:t.year,month:t.month,day:t.day,hour:t.hour}}let l="",o=0,r=!1;if(e&&e.jieqi&&e.bazi){l=e.jieqi,r=j.includes(l);const t=e.bazi.day,a=t.charAt(0),s=t.charAt(1),i=b.indexOf(a),n=p.indexOf(s),u=p[(n-i%5+12)%12];o=["子","午","卯","酉"].includes(u)?0:["寅","申","巳","亥"].includes(u)?1:2}else{let t=i.getLunar().getPrevJieQi(!0);if(!t)return{error:"日期超出范围"};l=t.getName();const a=t.getSolar(),e=(s.getTime()-new Date(a.toYmdHms()).getTime())/36e5,n=Math.floor(e/120);o=n>=2?2:n,r=j.includes(l)}let u=0;if(e&&e.ju)r=e.ju.isYang,u=e.ju.juNum,l||(l="手工");else{const t=k[l];if(!t)return{error:"未知节气: "+l};u=t[o]}const g=["上候","中候","下候"][o],c=(h=g,w[f=l]?w[f][h]||1:C[f]?C[f][h]||1:T[f]&&T[f][h]||1);var f,h;const d=S(c,D(n.year),r),z=S(d,D(n.month),r),_=S(z,D(n.day),r),I=S(_,D(n.hour),r),X=x[I],v=new Array(10).fill("");for(let m=1;m<=9;m++){let t;r?(t=(5+m-I+9)%9,0===t&&(t=9)):(t=(5-m+I+9)%9,0===t&&(t=9)),v[t]=x[m]}const W=v[_],B=["戊","己","庚","辛","壬","癸","丁","丙","乙"],Y=new Array(10).fill("");for(let m=0;m<9;m++){let t=0;if(r)t=(u+m-1)%9+1;else{let a=u-m;for(;a<=0;)a+=9;for(;a>9;)a-=9;t=a}Y[t]=B[m]}const $=new Array(10).fill("");for(let m=1;m<=9;m++){const t=v[m],a=x.indexOf(t);a>0&&($[m]=Y[a])}const A={year:{gz:n.year,xk:N(n.year),ny:G(n.year)},month:{gz:n.month,xk:N(n.month),ny:G(n.month)},day:{gz:n.day,xk:N(n.day),ny:G(n.day)},hour:{gz:n.hour,xk:N(n.hour),ny:G(n.hour)}},O={};for(let m=1;m<=9;m++)O[m]={star:v[m],earthStem:Y[m],skyStem:$[m],isTaisui:m===d,isYuejian:m===z,isRijian:m===_,isShijian:m===I};return{jieQi:l,yuan:["上元","中元","下元"][o],hou:g,juName:(r?"阳遁":"阴遁")+["一","二","三","四","五","六","七","八","九"][u-1]+"局",bazi:n,startGong:c,taisuiGong:d,yuejianGong:z,rijianGong:_,shijianGong:I,zhiFu:X,zhuXing:W,layout:{baziInfo:A,gongInfo:O,earth:Y,stars:v,skyStem:$}}}const v=_({data:()=>({options:{},result:{jieQi:"",yuan:"",juName:"",bazi:{year:"",month:"",day:"",hour:""},zhiFu:"",zhuXing:"",startGong:0,taisuiGong:0,yuejianGong:0,rijianGong:0,shijianGong:0,layout:{baziInfo:null,gongInfo:null,earth:[],stars:[],skyStem:[]}},gridLayout:[[4,9,2],[3,5,7],[8,1,6]],gridLayout:[[4,9,2],[3,5,7],[8,1,6]],xingnianBenming:null,customDateTime:null,useCustomTime:!1}),onLoad(a){this.options=a;try{this.calc()}catch(e){console.error("onLoad Error:",e),t({title:"加载出错",icon:"none"})}},methods:{goBack(){a()},goPrevious(){let t;t=this.useCustomTime&&this.customDateTime?new Date(this.customDateTime):this.options.date&&this.options.time?new Date(`${this.options.date}T${this.options.time}:00`):new Date,t.setHours(t.getHours()-2),this.customDateTime=t.toISOString(),this.useCustomTime=!0,this.options.mode="custom",this.options.date=this.formatDate(t),this.options.time=this.formatTime(t),this.calc()},goCurrentTime(){this.customDateTime=null,this.useCustomTime=!1,this.options.mode="current",this.options.date=null,this.options.time=null,this.calc()},goNext(){let t;t=this.useCustomTime&&this.customDateTime?new Date(this.customDateTime):this.options.date&&this.options.time?new Date(`${this.options.date}T${this.options.time}:00`):new Date,t.setHours(t.getHours()+2),this.customDateTime=t.toISOString(),this.useCustomTime=!0,this.options.mode="custom",this.options.date=this.formatDate(t),this.options.time=this.formatTime(t),this.calc()},calc(){try{let e,s,i={};if("current"!==this.options.mode&&"current-time"!==this.options.mode&&this.options.mode){if("custom"===this.options.mode)e=this.options.date,s=this.options.time;else if("sizhu"===this.options.mode){if(e="2000-01-01",s="12:00",this.options.bazi){const t=decodeURIComponent(this.options.bazi).split(","),a=decodeURIComponent(this.options.jieqi);i.bazi={year:t[0],month:t[1],day:t[2],hour:t[3]},i.jieqi=a}}else if("manual"===this.options.mode){const t=new Date;e=this.formatDate(t),s=this.formatTime(t)}}else{const t=new Date;e=this.formatDate(t),s=this.formatTime(t)}if(this.options.ju){const t=this.options.ju.split("-");2===t.length&&(i.ju={isYang:"yang"===t[0],juNum:parseInt(t[1])})}const n=X(e,s,i);if(n.error)return void t({title:n.error,icon:"none"});if(this.result=n,this.options.birthYear)try{const t=parseInt(this.options.birthYear),a="1"===this.options.gender,s=new Date(e).getFullYear(),i=z(t,a,s);this.xingnianBenming=i}catch(a){console.error("XingNian Calc Error",a)}}catch(a){console.error("Calc Error:",a),t({title:"排盘计算出错",icon:"none"})}},formatDate:t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`,formatTime(t){if(!t||isNaN(t.getTime()))return"00:00";return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},getGongName:t=>["","坎","坤","震","巽","中","乾","兑","艮","离"][t],getGongInfo(t){return this.result.layout.gongInfo&&this.result.layout.gongInfo[t]?this.result.layout.gongInfo[t]:{star:"",earthStem:"",skyStem:"",isTaisui:!1,isYuejian:!1,isRijian:!1,isShijian:!1}},getGan:t=>!t||t.length<1?"":t.charAt(0),getZhi:t=>!t||t.length<2?"":t.charAt(1),getWuXingClass:t=>t?"甲乙寅卯".includes(t)?"wx-wood":"丙丁巳午".includes(t)?"wx-fire":"戊己辰戌丑未".includes(t)?"wx-earth":"庚辛申酉".includes(t)?"wx-metal":"壬癸亥子".includes(t)?"wx-water":"木".includes(t)?"wx-wood":"火".includes(t)?"wx-fire":"土".includes(t)?"wx-earth":"金".includes(t)?"wx-metal":"水".includes(t)?"wx-water":"":"",getNaYinColor(t){if(!t)return"";const a=t.slice(-1);return this.getWuXingClass(a)}}},[["render",function(t,a,m,y,z,_){const b=d,p=i;return n(),e(p,{class:"container"},{default:s((()=>[l(p,{class:"nav-bar"},{default:s((()=>[l(p,{class:"back-btn",onClick:_.goBack},{default:s((()=>[l(b,{class:"back-icon"},{default:s((()=>[o("←")])),_:1}),l(b,{class:"back-text"},{default:s((()=>[o("返回")])),_:1})])),_:1},8,["onClick"]),l(b,{class:"nav-title"},{default:s((()=>[o("遁甲折衷")])),_:1}),l(p,{class:"nav-buttons"},{default:s((()=>[l(p,{class:"back-text",onClick:_.goPrevious},{default:s((()=>[l(b,{class:"nav-icon"},{default:s((()=>[o("◀")])),_:1})])),_:1},8,["onClick"]),l(p,{class:"back-text",onClick:_.goCurrentTime},{default:s((()=>[l(b,{class:"nav-icon"},{default:s((()=>[o("↻")])),_:1})])),_:1},8,["onClick"]),l(p,{class:"back-text",onClick:_.goNext},{default:s((()=>[l(b,{class:"nav-icon"},{default:s((()=>[o("▶")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),l(p,{class:"content"},{default:s((()=>[l(p,{class:"info-card"},{default:s((()=>[l(p,{class:"info-row main-title"},{default:s((()=>[l(b,{class:"info-text"},{default:s((()=>[o(r(z.result.jieQi)+" "+r(z.result.yuan),1)])),_:1}),l(b,{class:"info-text highlight"},{default:s((()=>[o(r(z.result.juName),1)])),_:1})])),_:1}),z.result.startGong?(n(),e(p,{key:0,class:"zezhong-info"},{default:s((()=>[l(p,{class:"zezhong-row"},{default:s((()=>[l(b,{class:"zezhong-label"},{default:s((()=>[o("天元起宫:")])),_:1}),l(b,{class:"zezhong-val"},{default:s((()=>[o(r(_.getGongName(z.result.startGong))+"("+r(z.result.startGong)+")",1)])),_:1}),l(b,{class:"zezhong-label",style:{"margin-left":"20rpx"}},{default:s((()=>[o("值符:")])),_:1}),l(b,{class:"zezhong-val"},{default:s((()=>[o(r(z.result.zhiFu),1)])),_:1}),l(b,{class:"zezhong-label",style:{"margin-left":"20rpx"}},{default:s((()=>[o("主星:")])),_:1}),l(b,{class:"zezhong-val"},{default:s((()=>[o(r(z.result.zhuXing),1)])),_:1})])),_:1})])),_:1})):u("",!0),z.result.layout.baziInfo?(n(),e(p,{key:1,class:"bazi-grid"},{default:s((()=>[l(p,{class:"bazi-row header-row"},{default:s((()=>[l(p,{class:"bazi-cell header-cell"},{default:s((()=>[l(b,null,{default:s((()=>[o("年")])),_:1})])),_:1}),l(p,{class:"bazi-cell header-cell"},{default:s((()=>[l(b,null,{default:s((()=>[o("月")])),_:1})])),_:1}),l(p,{class:"bazi-cell header-cell"},{default:s((()=>[l(b,null,{default:s((()=>[o("日")])),_:1})])),_:1}),l(p,{class:"bazi-cell header-cell"},{default:s((()=>[l(b,null,{default:s((()=>[o("时")])),_:1})])),_:1})])),_:1}),l(p,{class:"bazi-row"},{default:s((()=>[l(p,{class:"bazi-cell"},{default:s((()=>[l(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.year.gz)))},{default:s((()=>[o(r(_.getGan(z.result.layout.baziInfo.year.gz)),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.year.gz)))},{default:s((()=>[o(r(_.getZhi(z.result.layout.baziInfo.year.gz)),1)])),_:1},8,["class"])])),_:1}),l(p,{class:"bazi-cell"},{default:s((()=>[l(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.month.gz)))},{default:s((()=>[o(r(_.getGan(z.result.layout.baziInfo.month.gz)),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.month.gz)))},{default:s((()=>[o(r(_.getZhi(z.result.layout.baziInfo.month.gz)),1)])),_:1},8,["class"])])),_:1}),l(p,{class:"bazi-cell"},{default:s((()=>[l(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.day.gz)))},{default:s((()=>[o(r(_.getGan(z.result.layout.baziInfo.day.gz)),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.day.gz)))},{default:s((()=>[o(r(_.getZhi(z.result.layout.baziInfo.day.gz)),1)])),_:1},8,["class"])])),_:1}),l(p,{class:"bazi-cell"},{default:s((()=>[l(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.hour.gz)))},{default:s((()=>[o(r(_.getGan(z.result.layout.baziInfo.hour.gz)),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.hour.gz)))},{default:s((()=>[o(r(_.getZhi(z.result.layout.baziInfo.hour.gz)),1)])),_:1},8,["class"])])),_:1})])),_:1}),l(p,{class:"bazi-row gong-row"},{default:s((()=>[l(p,{class:g(["bazi-cell",{"highlight-gong":z.result.taisuiGong}])},{default:s((()=>[l(b,{class:"gong-marker taisui"},{default:s((()=>[o("岁"+r(z.result.taisuiGong),1)])),_:1})])),_:1},8,["class"]),l(p,{class:g(["bazi-cell",{"highlight-gong":z.result.yuejianGong}])},{default:s((()=>[l(b,{class:"gong-marker yuejian"},{default:s((()=>[o("月"+r(z.result.yuejianGong),1)])),_:1})])),_:1},8,["class"]),l(p,{class:g(["bazi-cell",{"highlight-gong":z.result.rijianGong}])},{default:s((()=>[l(b,{class:"gong-marker rijian"},{default:s((()=>[o("日"+r(z.result.rijianGong),1)])),_:1})])),_:1},8,["class"]),l(p,{class:g(["bazi-cell",{"highlight-gong":z.result.shijianGong}])},{default:s((()=>[l(b,{class:"gong-marker shijian"},{default:s((()=>[o("时"+r(z.result.shijianGong),1)])),_:1})])),_:1},8,["class"])])),_:1}),l(p,{class:"bazi-row"},{default:s((()=>[l(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.year.ny)])},{default:s((()=>[o(r(z.result.layout.baziInfo.year.ny),1)])),_:1},8,["class"]),l(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.month.ny)])},{default:s((()=>[o(r(z.result.layout.baziInfo.month.ny),1)])),_:1},8,["class"]),l(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.day.ny)])},{default:s((()=>[o(r(z.result.layout.baziInfo.day.ny),1)])),_:1},8,["class"]),l(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.hour.ny)])},{default:s((()=>[o(r(z.result.layout.baziInfo.hour.ny),1)])),_:1},8,["class"])])),_:1})])),_:1})):u("",!0),z.xingnianBenming?(n(),e(p,{key:2,class:"xingnian-info"},{default:s((()=>[l(b,null,{default:s((()=>[o("本命:")])),_:1}),l(b,{class:g(_.getWuXingClass(z.xingnianBenming.benming.gan))},{default:s((()=>[o(r(z.xingnianBenming.benming.gan),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(z.xingnianBenming.benming.zhi))},{default:s((()=>[o(r(z.xingnianBenming.benming.zhi),1)])),_:1},8,["class"]),l(b,{class:"xingnian-spacer"},{default:s((()=>[o("行年:")])),_:1}),l(b,{class:g(_.getWuXingClass(z.xingnianBenming.xingnian.gan))},{default:s((()=>[o(r(z.xingnianBenming.xingnian.gan),1)])),_:1},8,["class"]),l(b,{class:g(_.getWuXingClass(z.xingnianBenming.xingnian.zhi))},{default:s((()=>[o(r(z.xingnianBenming.xingnian.zhi),1)])),_:1},8,["class"]),l(b,{class:"xingnian-spacer"},{default:s((()=>[o(r(z.xingnianBenming.birthYear)+"年",1)])),_:1}),l(b,{class:g(["gender-badge",z.xingnianBenming.isMale?"male":"female"])},{default:s((()=>[o(r(z.xingnianBenming.gender),1)])),_:1},8,["class"])])),_:1})):u("",!0)])),_:1}),l(p,{class:"grid-container"},{default:s((()=>[(n(!0),c(h,null,f(z.gridLayout,((t,a)=>(n(),e(p,{class:"grid-row",key:a},{default:s((()=>[(n(!0),c(h,null,f(t,((t,a)=>(n(),e(p,{class:g(["grid-cell",["gong-"+t,{center:5===t,"is-taisui":t===z.result.taisuiGong,"is-rijian":t===z.result.rijianGong,"is-shijian":t===z.result.shijianGong}]]),key:a},{default:s((()=>[l(p,{class:"gong-bg"},{default:s((()=>[o(r(_.getGongName(t)),1)])),_:2},1024),z.result.layout.gongInfo?(n(),e(p,{key:0,class:"cell-content"},{default:s((()=>[l(p,{class:"star-row"},{default:s((()=>[l(b,{class:"star-name"},{default:s((()=>[o(r(_.getGongInfo(t).star),1)])),_:2},1024)])),_:2},1024),l(p,{class:"stem-row"},{default:s((()=>[l(b,{class:g(["sky-stem",_.getWuXingClass(_.getGongInfo(t).skyStem)])},{default:s((()=>[o(r(_.getGongInfo(t).skyStem),1)])),_:2},1032,["class"])])),_:2},1024),l(p,{class:"marker-row"},{default:s((()=>[_.getGongInfo(t).isTaisui?(n(),e(b,{key:0,class:"marker taisui-marker"},{default:s((()=>[o("岁")])),_:1})):u("",!0),_.getGongInfo(t).isYuejian?(n(),e(b,{key:1,class:"marker yuejian-marker"},{default:s((()=>[o("月")])),_:1})):u("",!0),_.getGongInfo(t).isRijian?(n(),e(b,{key:2,class:"marker rijian-marker"},{default:s((()=>[o("日")])),_:1})):u("",!0),_.getGongInfo(t).isShijian?(n(),e(b,{key:3,class:"marker shijian-marker"},{default:s((()=>[o("时")])),_:1})):u("",!0)])),_:2},1024)])),_:2},1024)):u("",!0)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1})])),_:1}),l(p,{class:"copyright-info"},{default:s((()=>[l(p,{class:"copyright-line"},{default:s((()=>[o("© Developer: 景川 · Wechat: Im_JingChuang")])),_:1}),l(p,{class:"copyright-line"},{default:s((()=>[o("© Technical supporter: 卿核 · Wechat: qinghe4994")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-9a783362"]]);export{v as default};
