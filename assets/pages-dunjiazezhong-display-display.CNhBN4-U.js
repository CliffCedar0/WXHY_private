import{s as a,v as e,c as t,w as n,i as s,o as l,a as i,b as o,t as r,h as u,l as g,g as c,k as f,F as d,e as h}from"./index-D3ps0f3j.js";import{l as y,a as m}from"./sizhu.j5o8EW_k.js";import{g as z}from"./xingnian.CHB5KPs2.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],j=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],x=["","天蓬","天芮","天冲","天辅","天禽","天心","天柱","天任","天英"],I=["冬至","小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种"],p={"冬至":[1,7,4],"小寒":[2,8,5],"大寒":[3,9,6],"立春":[8,5,2],"雨水":[9,6,3],"惊蛰":[1,7,4],"春分":[3,9,6],"清明":[4,1,7],"谷雨":[5,2,8],"立夏":[4,1,7],"小满":[5,2,8],"芒种":[6,3,9],"夏至":[9,3,6],"小暑":[8,2,5],"大暑":[7,1,4],"立秋":[2,5,8],"处暑":[1,4,7],"白露":[9,3,6],"秋分":[7,1,4],"寒露":[6,3,9],"霜降":[5,2,8],"立冬":[6,3,9],"小雪":[5,2,8],"大雪":[4,1,7]},G={"甲子":"海中金","乙丑":"海中金","丙寅":"炉中火","丁卯":"炉中火","戊辰":"大林木","己巳":"大林木","庚午":"路旁土","辛未":"路旁土","壬申":"剑锋金","癸酉":"剑锋金","甲戌":"山头火","乙亥":"山头火","丙子":"涧下水","丁丑":"涧下水","戊寅":"城头土","己卯":"城头土","庚辰":"白蜡金","辛巳":"白蜡金","壬午":"杨柳木","癸未":"杨柳木","甲申":"泉中水","乙酉":"泉中水","丙戌":"屋上土","丁亥":"屋上土","戊子":"霹雳火","己丑":"霹雳火","庚寅":"松柏木","辛卯":"松柏木","壬辰":"长流水","癸巳":"长流水","甲午":"沙中金","乙未":"沙中金","丙申":"山下火","丁酉":"山下火","戊戌":"平地木","己亥":"平地木","庚子":"壁上土","辛丑":"壁上土","壬寅":"金箔金","癸卯":"金箔金","甲辰":"佛灯火","乙巳":"佛灯火","丙午":"天河水","丁未":"天河水","戊申":"大驿土","己酉":"大驿土","庚戌":"钗钏金","辛亥":"钗钏金","壬子":"桑柘木","癸丑":"桑柘木","甲寅":"大溪水","乙卯":"大溪水","丙辰":"沙中土","丁巳":"沙中土","戊午":"天上火","己未":"天上火","庚申":"石榴木","辛酉":"石榴木","壬戌":"大海水","癸亥":"大海水"},k=a=>G[a]||"",w={"冬至":{"上候":1,"中候":7,"下候":4},"立春":{"上候":8,"中候":5,"下候":2},"春分":{"上候":3,"中候":9,"下候":6},"立夏":{"上候":4,"中候":1,"下候":7},"夏至":{"上候":9,"中候":3,"下候":6},"立秋":{"上候":2,"中候":5,"下候":8},"秋分":{"上候":7,"中候":1,"下候":4},"立冬":{"上候":6,"中候":3,"下候":9}},C={"小寒":{"上候":2,"中候":8,"下候":5},"雨水":{"上候":9,"中候":6,"下候":3},"清明":{"上候":4,"中候":1,"下候":7},"小满":{"上候":5,"中候":2,"下候":8},"小暑":{"上候":8,"中候":2,"下候":5},"处暑":{"上候":1,"中候":4,"下候":7},"寒露":{"上候":6,"中候":9,"下候":3},"小雪":{"上候":5,"中候":8,"下候":2}},S={"大寒":{"上候":3,"中候":9,"下候":6},"惊蛰":{"上候":1,"中候":7,"下候":4},"谷雨":{"上候":5,"中候":2,"下候":8},"芒种":{"上候":6,"中候":3,"下候":9},"大暑":{"上候":9,"中候":1,"下候":4},"白露":{"上候":6,"中候":3,"下候":6},"霜降":{"上候":7,"中候":1,"下候":4},"大雪":{"上候":7,"中候":1,"下候":1}};function X(a){if(!a||a.length<2)return 1;const e=a[0],t=a[1],n=b.indexOf(e),s=j.indexOf(t);if(-1===n||-1===s)return 1;for(let l=0;l<60;l++){const a=b[l%10],n=j[l%12];if(a===e&&n===t)return l+1}return 1}function W(a,e,t){let n=a;const s=(e-1)%9;for(let l=0;l<s;l++)n=t?n%9+1:1===n?9:n-1;return n}function N(a){if(!a||a.length<2)return"";const e=a.charAt(0),t=a.charAt(1),n=b.indexOf(e),s=j.indexOf(t);if(-1===n||-1===s)return"";const l=(s-n+12)%12;return j[(l+10)%12]+j[(l+11)%12]}function B(a,e,t={}){const n=new Date(`${a}T${e}:00`),s=y.Solar.fromDate(n);let l={};if(t&&t.bazi)l=t.bazi;else{const a=m(n);if(!a)return{error:"四柱计算失败"};l={year:a.year,month:a.month,day:a.day,hour:a.hour}}let i="",o=0,r=!1;if(t&&t.jieqi&&t.bazi){i=t.jieqi,r=I.includes(i);const a=t.bazi.day,e=a.charAt(0),n=a.charAt(1),s=b.indexOf(e),l=j.indexOf(n),u=j[(l-s%5+12)%12];o=["子","午","卯","酉"].includes(u)?0:["寅","申","巳","亥"].includes(u)?1:2}else{let a=s.getLunar().getPrevJieQi(!0);if(!a)return{error:"日期超出范围"};i=a.getName();const e=a.getSolar(),t=(n.getTime()-new Date(e.toYmdHms()).getTime())/36e5,l=Math.floor(t/120);o=l>=2?2:l,r=I.includes(i)}let u=0;if(t&&t.ju)r=t.ju.isYang,u=t.ju.juNum,i||(i="手工");else{const a=p[i];if(!a)return{error:"未知节气: "+i};u=a[o]}const g=["上候","中候","下候"][o],c=(d=g,w[f=i]?w[f][d]||1:C[f]?C[f][d]||1:S[f]&&S[f][d]||1);var f,d;const h=W(c,X(l.year),r),z=W(h,X(l.month),r),_=W(z,X(l.day),r),G=W(_,X(l.hour),r),B=x[G],Y=new Array(10).fill("");for(let y=1;y<=9;y++){let a;r?(a=(5+y-G+9)%9,0===a&&(a=9)):(a=(5-y+G+9)%9,0===a&&(a=9)),Y[a]=x[y]}const v=Y[_],D=["戊","己","庚","辛","壬","癸","丁","丙","乙"],T=new Array(10).fill("");for(let y=0;y<9;y++){let a=0;if(r)a=(u+y-1)%9+1;else{let e=u-y;for(;e<=0;)e+=9;for(;e>9;)e-=9;a=e}T[a]=D[y]}const A=new Array(10).fill("");for(let y=1;y<=9;y++){const a=Y[y],e=x.indexOf(a);e>0&&(A[y]=T[e])}const Z={year:{gz:l.year,xk:N(l.year),ny:k(l.year)},month:{gz:l.month,xk:N(l.month),ny:k(l.month)},day:{gz:l.day,xk:N(l.day),ny:k(l.day)},hour:{gz:l.hour,xk:N(l.hour),ny:k(l.hour)}},O={};for(let y=1;y<=9;y++)O[y]={star:Y[y],earthStem:T[y],skyStem:A[y],isTaisui:y===h,isYuejian:y===z,isRijian:y===_,isShijian:y===G};return{jieQi:i,yuan:["上元","中元","下元"][o],hou:g,juName:(r?"阳遁":"阴遁")+["一","二","三","四","五","六","七","八","九"][u-1]+"局",bazi:l,startGong:c,taisuiGong:h,yuejianGong:z,rijianGong:_,shijianGong:G,zhiFu:B,zhuXing:v,layout:{baziInfo:Z,gongInfo:O,earth:T,stars:Y,skyStem:A}}}const Y=_({data:()=>({options:{},result:{jieQi:"",yuan:"",juName:"",bazi:{year:"",month:"",day:"",hour:""},zhiFu:"",zhuXing:"",startGong:0,taisuiGong:0,yuejianGong:0,rijianGong:0,shijianGong:0,layout:{baziInfo:null,gongInfo:null,earth:[],stars:[],skyStem:[]}},gridLayout:[[4,9,2],[3,5,7],[8,1,6]],xingnianBenming:null}),onLoad(e){this.options=e;try{this.calc()}catch(t){console.error("onLoad Error:",t),a({title:"加载出错",icon:"none"})}},methods:{goBack(){e()},calc(){try{let t,n,s={};if("current"!==this.options.mode&&"current-time"!==this.options.mode&&this.options.mode){if("custom"===this.options.mode)t=this.options.date,n=this.options.time;else if("sizhu"===this.options.mode){if(t="2000-01-01",n="12:00",this.options.bazi){const a=decodeURIComponent(this.options.bazi).split(","),e=decodeURIComponent(this.options.jieqi);s.bazi={year:a[0],month:a[1],day:a[2],hour:a[3]},s.jieqi=e}}else if("manual"===this.options.mode){const a=new Date;t=this.formatDate(a),n=this.formatTime(a)}}else{const a=new Date;t=this.formatDate(a),n=this.formatTime(a)}if(this.options.ju){const a=this.options.ju.split("-");2===a.length&&(s.ju={isYang:"yang"===a[0],juNum:parseInt(a[1])})}const l=B(t,n,s);if(l.error)return void a({title:l.error,icon:"none"});if(this.result=l,this.options.birthYear)try{const a=parseInt(this.options.birthYear),e="1"===this.options.gender,n=new Date(t).getFullYear(),s=z(a,e,n);this.xingnianBenming=s}catch(e){console.error("XingNian Calc Error",e)}}catch(e){console.error("Calc Error:",e),a({title:"排盘计算出错",icon:"none"})}},formatDate:a=>`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`,formatTime(a){if(!a||isNaN(a.getTime()))return"00:00";return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},getGongName:a=>["","坎","坤","震","巽","中","乾","兑","艮","离"][a],getGongInfo(a){return this.result.layout.gongInfo&&this.result.layout.gongInfo[a]?this.result.layout.gongInfo[a]:{star:"",earthStem:"",skyStem:"",isTaisui:!1,isYuejian:!1,isRijian:!1,isShijian:!1}},getGan:a=>!a||a.length<1?"":a.charAt(0),getZhi:a=>!a||a.length<2?"":a.charAt(1),getWuXingClass:a=>a?"甲乙寅卯".includes(a)?"wx-wood":"丙丁巳午".includes(a)?"wx-fire":"戊己辰戌丑未".includes(a)?"wx-earth":"庚辛申酉".includes(a)?"wx-metal":"壬癸亥子".includes(a)?"wx-water":"木".includes(a)?"wx-wood":"火".includes(a)?"wx-fire":"土".includes(a)?"wx-earth":"金".includes(a)?"wx-metal":"水".includes(a)?"wx-water":"":"",getNaYinColor(a){if(!a)return"";const e=a.slice(-1);return this.getWuXingClass(e)}}},[["render",function(a,e,y,m,z,_){const b=h,j=s;return l(),t(j,{class:"container"},{default:n((()=>[i(j,{class:"nav-bar"},{default:n((()=>[i(j,{class:"back-btn",onClick:_.goBack},{default:n((()=>[i(b,{class:"back-icon"},{default:n((()=>[o("←")])),_:1}),i(b,{class:"back-text"},{default:n((()=>[o("返回")])),_:1})])),_:1},8,["onClick"]),i(b,{class:"nav-title"},{default:n((()=>[o("遁甲择衷")])),_:1}),i(j,{class:"placeholder"})])),_:1}),i(j,{class:"content"},{default:n((()=>[i(j,{class:"info-card"},{default:n((()=>[i(j,{class:"info-row main-title"},{default:n((()=>[i(b,{class:"info-text"},{default:n((()=>[o(r(z.result.jieQi)+" "+r(z.result.yuan),1)])),_:1}),i(b,{class:"info-text highlight"},{default:n((()=>[o(r(z.result.juName),1)])),_:1})])),_:1}),z.result.startGong?(l(),t(j,{key:0,class:"zezhong-info"},{default:n((()=>[i(j,{class:"zezhong-row"},{default:n((()=>[i(b,{class:"zezhong-label"},{default:n((()=>[o("天元起宫:")])),_:1}),i(b,{class:"zezhong-val"},{default:n((()=>[o(r(_.getGongName(z.result.startGong))+"("+r(z.result.startGong)+")",1)])),_:1}),i(b,{class:"zezhong-label",style:{"margin-left":"20rpx"}},{default:n((()=>[o("值符:")])),_:1}),i(b,{class:"zezhong-val"},{default:n((()=>[o(r(z.result.zhiFu),1)])),_:1}),i(b,{class:"zezhong-label",style:{"margin-left":"20rpx"}},{default:n((()=>[o("主星:")])),_:1}),i(b,{class:"zezhong-val"},{default:n((()=>[o(r(z.result.zhuXing),1)])),_:1})])),_:1})])),_:1})):u("",!0),z.result.layout.baziInfo?(l(),t(j,{key:1,class:"bazi-grid"},{default:n((()=>[i(j,{class:"bazi-row header-row"},{default:n((()=>[i(j,{class:"bazi-cell header-cell"},{default:n((()=>[i(b,null,{default:n((()=>[o("年")])),_:1})])),_:1}),i(j,{class:"bazi-cell header-cell"},{default:n((()=>[i(b,null,{default:n((()=>[o("月")])),_:1})])),_:1}),i(j,{class:"bazi-cell header-cell"},{default:n((()=>[i(b,null,{default:n((()=>[o("日")])),_:1})])),_:1}),i(j,{class:"bazi-cell header-cell"},{default:n((()=>[i(b,null,{default:n((()=>[o("时")])),_:1})])),_:1})])),_:1}),i(j,{class:"bazi-row"},{default:n((()=>[i(j,{class:"bazi-cell"},{default:n((()=>[i(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.year.gz)))},{default:n((()=>[o(r(_.getGan(z.result.layout.baziInfo.year.gz)),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.year.gz)))},{default:n((()=>[o(r(_.getZhi(z.result.layout.baziInfo.year.gz)),1)])),_:1},8,["class"])])),_:1}),i(j,{class:"bazi-cell"},{default:n((()=>[i(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.month.gz)))},{default:n((()=>[o(r(_.getGan(z.result.layout.baziInfo.month.gz)),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.month.gz)))},{default:n((()=>[o(r(_.getZhi(z.result.layout.baziInfo.month.gz)),1)])),_:1},8,["class"])])),_:1}),i(j,{class:"bazi-cell"},{default:n((()=>[i(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.day.gz)))},{default:n((()=>[o(r(_.getGan(z.result.layout.baziInfo.day.gz)),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.day.gz)))},{default:n((()=>[o(r(_.getZhi(z.result.layout.baziInfo.day.gz)),1)])),_:1},8,["class"])])),_:1}),i(j,{class:"bazi-cell"},{default:n((()=>[i(b,{class:g(_.getWuXingClass(_.getGan(z.result.layout.baziInfo.hour.gz)))},{default:n((()=>[o(r(_.getGan(z.result.layout.baziInfo.hour.gz)),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(_.getZhi(z.result.layout.baziInfo.hour.gz)))},{default:n((()=>[o(r(_.getZhi(z.result.layout.baziInfo.hour.gz)),1)])),_:1},8,["class"])])),_:1})])),_:1}),i(j,{class:"bazi-row gong-row"},{default:n((()=>[i(j,{class:g(["bazi-cell",{"highlight-gong":z.result.taisuiGong}])},{default:n((()=>[i(b,{class:"gong-marker taisui"},{default:n((()=>[o("岁"+r(z.result.taisuiGong),1)])),_:1})])),_:1},8,["class"]),i(j,{class:g(["bazi-cell",{"highlight-gong":z.result.yuejianGong}])},{default:n((()=>[i(b,{class:"gong-marker yuejian"},{default:n((()=>[o("月"+r(z.result.yuejianGong),1)])),_:1})])),_:1},8,["class"]),i(j,{class:g(["bazi-cell",{"highlight-gong":z.result.rijianGong}])},{default:n((()=>[i(b,{class:"gong-marker rijian"},{default:n((()=>[o("日"+r(z.result.rijianGong),1)])),_:1})])),_:1},8,["class"]),i(j,{class:g(["bazi-cell",{"highlight-gong":z.result.shijianGong}])},{default:n((()=>[i(b,{class:"gong-marker shijian"},{default:n((()=>[o("时"+r(z.result.shijianGong),1)])),_:1})])),_:1},8,["class"])])),_:1}),i(j,{class:"bazi-row"},{default:n((()=>[i(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.year.ny)])},{default:n((()=>[o(r(z.result.layout.baziInfo.year.ny),1)])),_:1},8,["class"]),i(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.month.ny)])},{default:n((()=>[o(r(z.result.layout.baziInfo.month.ny),1)])),_:1},8,["class"]),i(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.day.ny)])},{default:n((()=>[o(r(z.result.layout.baziInfo.day.ny),1)])),_:1},8,["class"]),i(b,{class:g(["bazi-cell",_.getNaYinColor(z.result.layout.baziInfo.hour.ny)])},{default:n((()=>[o(r(z.result.layout.baziInfo.hour.ny),1)])),_:1},8,["class"])])),_:1})])),_:1})):u("",!0),z.xingnianBenming?(l(),t(j,{key:2,class:"xingnian-info"},{default:n((()=>[i(b,null,{default:n((()=>[o("本命:")])),_:1}),i(b,{class:g(_.getWuXingClass(z.xingnianBenming.benming.gan))},{default:n((()=>[o(r(z.xingnianBenming.benming.gan),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(z.xingnianBenming.benming.zhi))},{default:n((()=>[o(r(z.xingnianBenming.benming.zhi),1)])),_:1},8,["class"]),i(b,{class:"xingnian-spacer"},{default:n((()=>[o("行年:")])),_:1}),i(b,{class:g(_.getWuXingClass(z.xingnianBenming.xingnian.gan))},{default:n((()=>[o(r(z.xingnianBenming.xingnian.gan),1)])),_:1},8,["class"]),i(b,{class:g(_.getWuXingClass(z.xingnianBenming.xingnian.zhi))},{default:n((()=>[o(r(z.xingnianBenming.xingnian.zhi),1)])),_:1},8,["class"]),i(b,{class:"xingnian-spacer"},{default:n((()=>[o(r(z.xingnianBenming.birthYear)+"年",1)])),_:1}),i(b,{class:g(["gender-badge",z.xingnianBenming.isMale?"male":"female"])},{default:n((()=>[o(r(z.xingnianBenming.gender),1)])),_:1},8,["class"])])),_:1})):u("",!0)])),_:1}),i(j,{class:"grid-container"},{default:n((()=>[(l(!0),c(d,null,f(z.gridLayout,((a,e)=>(l(),t(j,{class:"grid-row",key:e},{default:n((()=>[(l(!0),c(d,null,f(a,((a,e)=>(l(),t(j,{class:g(["grid-cell",["gong-"+a,{center:5===a,"is-taisui":a===z.result.taisuiGong,"is-rijian":a===z.result.rijianGong,"is-shijian":a===z.result.shijianGong}]]),key:e},{default:n((()=>[i(j,{class:"gong-bg"},{default:n((()=>[o(r(_.getGongName(a)),1)])),_:2},1024),z.result.layout.gongInfo?(l(),t(j,{key:0,class:"cell-content"},{default:n((()=>[i(j,{class:"stem-row"},{default:n((()=>[i(b,{class:g(["sky-stem",_.getWuXingClass(_.getGongInfo(a).skyStem)])},{default:n((()=>[o(r(_.getGongInfo(a).skyStem),1)])),_:2},1032,["class"]),i(b,{class:g(["earth-stem",_.getWuXingClass(_.getGongInfo(a).earthStem)])},{default:n((()=>[o(r(_.getGongInfo(a).earthStem),1)])),_:2},1032,["class"])])),_:2},1024),i(j,{class:"star-row"},{default:n((()=>[i(b,{class:"star-name"},{default:n((()=>[o(r(_.getGongInfo(a).star),1)])),_:2},1024)])),_:2},1024),i(j,{class:"marker-row"},{default:n((()=>[_.getGongInfo(a).isTaisui?(l(),t(b,{key:0,class:"marker taisui-marker"},{default:n((()=>[o("岁")])),_:1})):u("",!0),_.getGongInfo(a).isYuejian?(l(),t(b,{key:1,class:"marker yuejian-marker"},{default:n((()=>[o("月")])),_:1})):u("",!0),_.getGongInfo(a).isRijian?(l(),t(b,{key:2,class:"marker rijian-marker"},{default:n((()=>[o("日")])),_:1})):u("",!0),_.getGongInfo(a).isShijian?(l(),t(b,{key:3,class:"marker shijian-marker"},{default:n((()=>[o("时")])),_:1})):u("",!0)])),_:2},1024)])),_:2},1024)):u("",!0)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1})])),_:1}),i(j,{class:"copyright-info"},{default:n((()=>[i(j,{class:"copyright-line"},{default:n((()=>[o("© Developer: 景川 · Wechat: Im_JingChuang")])),_:1}),i(j,{class:"copyright-line"},{default:n((()=>[o("© Technical supporter: 卿核 · Wechat: qinghe4994")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-0da23838"]]);export{Y as default};
